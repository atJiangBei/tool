(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5fefb6d7"],{"159b":function(t,e,n){var i=n("da84"),a=n("fdbc"),r=n("17c2"),s=n("9112");for(var o in a){var c=i[o],l=c&&c.prototype;if(l&&l.forEach!==r)try{s(l,"forEach",r)}catch(d){l.forEach=r}}},"15f1":function(t,e,n){},"17c2":function(t,e,n){"use strict";var i=n("b727").forEach,a=n("a640"),r=n("ae40"),s=a("forEach"),o=r("forEach");t.exports=s&&o?[].forEach:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}},"1dde":function(t,e,n){var i=n("d039"),a=n("b622"),r=n("2d00"),s=a("species");t.exports=function(t){return r>=51||!i((function(){var e=[],n=e.constructor={};return n[s]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}},"1fbd":function(t,e,n){"use strict";n("15f1")},"3f46":function(t,e,n){"use strict";n.r(e);var i=n("7a23"),a={class:"create-container"},r=Object(i["g"])('<div class="do-container"><h3>初始画布</h3><div><div class="layer-size-container"><label>高:</label><input type="number" value="1080" min="1080" max="3000" id="canvasHeight" placeholder="高度"><label>宽:</label><input type="number" value="720" min="720" max="2000" id="canvasWidth" placeholder="宽度"></div><div class="layer-rgb-container" id="layerRgbContainer"><div><label>R:</label><input type="number" value="240" min="0" max="255" placeholder="高度"></div><label>G:</label><input type="number" value="240" min="0" max="255" placeholder="宽度"><label>B:</label><input type="number" value="240" min="0" max="255" placeholder="宽度"><div class="preview-block-container"><div class="create-img-btn" data-type="preview">预览</div><div class="block-rgb-container" id="blockRgbContainer" style="background:rgb(240,240,240);"></div></div></div><div class="init-create-canvas"><div class="create-img-btn" id="createCanvas">生成画布</div><div class="create-img-btn" id="resetCanvas">重置画布</div></div></div><h3>新增图层</h3><div class="add-img-to-canvas" id="addImgToCanvas"><input type="file" id="uploadControl" accept="image/png,image/jpeg,image/jpg"></div><h3>图层位置调整度</h3><div class="console-container"><ul class="threshold-container"><li class="threshold-add" id="thresholdAdd"></li><li class="threshold-value" id="thresholdValue">1</li><li class="threshold-reduce" id="thresholdReduce"></li></ul></div><h3>当前图层</h3><div class="current-layer-container" id="currentLayerContainer"></div><h3>最终</h3><div class="last-container"><div class="create-img-btn" id="previewBlockImg">预览</div><div class="create-img-btn" id="submitSave">保存上传</div></div></div><div class="canvas-simulation" id="canvasSimulation"></div><div class="create-img-block-popup" id="createImgBlockPopup"><span data-type="close"></span><img src="" id="blockCanvasContent"></div>',3);function s(t,e,n,s,o,c){return Object(i["s"])(),Object(i["e"])("div",a,[r])}n("99af"),n("4160"),n("c975"),n("d81d"),n("fb6a"),n("45fc"),n("a434"),n("b0c0"),n("d3b7"),n("159b");function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function l(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),t}function d(t){var e=t.el,n=t.background,i=t.width,a=t.height,r=t.data,s=e.getContext("2d");s.fillStyle=n,s.fillRect(0,0,i,a);var o=r.slice();while(o.length){var c=o.shift();s.drawImage(c.el,0,0,c.width,c.height,c.left,c.top,c.width,c.height)}return e}function u(t,e,n,i){Object.defineProperty(t,e,{get:function(){return n},set:function(t){n=t,i&&i(n)}})}function h(t){return new Promise((function(e){var n=new FileReader;n.onload=function(t){e(t.target.result)},n.readAsDataURL(t)}))}function v(t,e,n){var i="";return n&&(i='checked="true"'),'<div class="set-size-container">\n\t\t\t\t<div class="set-size-head">\n\t\t\t\t\t图层信息\n\t\t\t\t\t<span data-type=\'delete\'></span>\n\t\t\t\t</div>\n\t\t\t\t<div class="set-layer-name">\n\t\t\t\t\t图片名称：'.concat(e,'\n\t\t\t\t</div>\n\t\t\t\t<div class="set-size-content">\n\t\t\t\t\t<div class="set-size-add" data-type=\'add\'></div>\n\t\t\t\t\t<div class="set-size-block">').concat(t,'</div>\n\t\t\t\t\t<div class="set-size-reduce" data-type=\'reduce\'></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="set-position-content">\n\t\t\t\t\t<div class="set-position-xy">\n\t\t\t\t\t\t<label>x:</label>\n\t\t\t\t\t\t<input type="number" data-type=\'x\' value="0" min="0"/>\n\t\t\t\t\t\t<label>y:</label>\n\t\t\t\t\t\t<input type="number" data-type=\'y\' value="0" min="0"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="set-position-container">\n\t\t\t\t\t\t<div class="create-img-btn"  data-type=\'setxy\'>根据xy坐标调整位置</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="set-layer-attribute">\n\t\t\t\t\t<label>是否为人像层：</label>\n\t\t\t\t\t<input type="checkbox" data-type="ispeople" ').concat(i,"/>\n\t\t\t\t</div>\n\t\t\t</div>")}var f=function(){function t(e){var n=this,i=e.el,a=e.left,r=e.top,s=e.width,c=e.height,l=e.parentHeight,d=e.parentWidth,u=e.check;o(this,t),this.el="string"===typeof i?document.querySelector(i):i,this.left=a,this.top=r,this.minLeft=0,this.minTop=0,this.parentHeight=l,this.parentWidth=d,this.canMove=!1,this.el.addEventListener("mousedown",(function(t){return n.mousedown(t)})),this.el.addEventListener("mousemove",(function(t){return n.mousemove(t)})),document.addEventListener("mouseup",(function(t){return n.mouseup(t)})),this.el.addEventListener("dblclick",(function(t){return n.select(t)})),this.startX=0,this.startY=0,this.height=c,this.width=s,this.maxTop=this.parentHeight-this.height,this.maxLeft=this.parentWidth-this.width,this.checked=!1,this.check=u,this.setPosition(this.left,this.top)}return l(t,[{key:"setBoundary",value:function(){}},{key:"select",value:function(){this.checked=!this.checked,this.el.classList.toggle("canvas-layer-selected"),this.check&&this.check(this.checked)}},{key:"blur",value:function(){this.checked=!this.checked,this.el.classList.remove("canvas-layer-selected")}},{key:"mousedown",value:function(t){this.canMove=!0,this.startX=t.pageX,this.startY=t.pageY,console.log()}},{key:"mousemove",value:function(t){this.canMove&&(this.left+=t.pageX-this.startX,this.top+=t.pageY-this.startY,this.setPosition(this.left,this.top),this.startX=t.pageX,this.startY=t.pageY,t.preventDefault())}},{key:"mouseup",value:function(){this.canMove=!1}},{key:"setPosition",value:function(){this.left=Math.max(this.minLeft,this.left),this.left=Math.min(this.maxLeft,this.left),this.top=Math.max(this.minTop,this.top),this.top=Math.min(this.maxTop,this.top),this.el.style.transform="translate3d(".concat(this.left,"px, ").concat(this.top,"px, 0px)")}},{key:"setWidth",value:function(t){this.el.style.width=t+"px"}},{key:"setzIndex",value:function(t){this.zIndex=t,this.el.style.zIndex=t}},{key:"handDo",value:function(t,e){"x"===e&&(this.left+=t),"y"===e&&(this.top+=t),this.setPosition()}},{key:"moveTo",value:function(t,e){t=parseInt(t),e=parseInt(e),t===t&&e===e&&(this.left=t,this.top=e,this.setPosition())}}]),t}(),p=function(){function t(){o(this,t),this.list=[],this.maxLength=4}return l(t,[{key:"add",value:function(t){this.list.length!==this.maxLength&&(t.setzIndex(this.list.length),this.list.push(t))}},{key:"forward",value:function(t){var e=this.list,n=e.indexOf(t);e.length<2||n<0||n!==e.length-1&&(e.splice(n,1),e.splice(n+1,0,t),this.resetZindex())}},{key:"backoff",value:function(t){var e=this.list,n=e.indexOf(t);e.length<2||n<1||n!==e.length&&(e.splice(n,1),e.splice(n-1,0,t),this.resetZindex())}},{key:"deleteItem",value:function(t){var e=this.list.indexOf(t);e>-1&&(this.list.splice(e,1),this.resetZindex())}},{key:"resetZindex",value:function(){this.list.forEach((function(t,e){t.setzIndex(e)}))}}]),t}();function m(t){return"rgb("+t[0]+","+t[1]+","+t[2]+")"}function g(t,e,n){var i=y.canvasSize;return new f({el:t,left:0,top:0,width:e,height:n,parentHeight:i.height,parentWidth:i.width,check:function(t){t?(y.varRemovableLayer&&y.varRemovableLayer.blur(),y.varRemovableLayer=this):y.varRemovableLayer=null}})}var y={thresholdValue:1,rgb:[240,240,240],canvasSize:{width:720,height:1080},Images:[],varRemovableLayer:null},b={mounted:function(){var t=new p;u(y,"varRemovableLayer",null,(function(t){console.log(t),x.innerHTML=t?v(t.zIndex,t.imgName,t.isPeople):""}));var e=!0,n=document.getElementById("createCanvas"),i=document.getElementById("resetCanvas"),a=document.getElementById("layerRgbContainer"),r=document.getElementById("blockRgbContainer"),s=a.getElementsByTagName("input"),o=document.getElementById("canvasHeight"),c=document.getElementById("canvasWidth"),l=document.getElementById("canvasSimulation");a.addEventListener("click",(function(t){var e=t.target;if("preview"===e.dataset.type){var n=s,i=[].slice.call(n).map((function(t){return t.value}));r.style.background=m(i)}})),n.addEventListener("click",(function(){if(e){var t=[].slice.call(s).map((function(t){return t.value}));console.log(t),y.rgb=t,y.canvasSize.width=c.value,y.canvasSize.height=o.value,l.style.background=m(t),l.style.width=c.value+"px",l.style.height=o.value+"px"}else alert("您已生成画布，次过程中不允许中途再次操做，如需重新生成，请重置画布")})),i.addEventListener("click",(function(){var t=confirm("您将重置画布");t&&window.location.reload()}));var f=document.getElementById("thresholdAdd"),b=document.getElementById("thresholdReduce"),k=document.getElementById("thresholdValue"),L=document.getElementById("uploadControl");f.addEventListener("click",(function(){y.thresholdValue>=17||(y.thresholdValue+=2,k.innerHTML=y.thresholdValue)})),b.addEventListener("click",(function(){y.thresholdValue<2||(y.thresholdValue-=2,k.innerHTML=y.thresholdValue)})),L.addEventListener("change",(function(n){if(t.list.length>=t.maxLength)return alert("最多只能只能由"+t.maxLength+"个图层"),void(i.value="");var i=n.target,a=i.files[0];console.log(a),h(a).then((function(n){i.value="";var r=document.createElement("img");r.src=n;var s=new Image;s.src=n;var o=function(){var n=y.canvasSize,i=n.width,s=n.height;if(this.width>i||this.height>s)alert("不允许图层宽高大于画布宽高");else{l.appendChild(r);var o=g(r,this.width,this.height);o.imgName=a.name,t.add(o),e=!1}};s.addEventListener("load",o)}))})),document.onkeyup=function(t){var e=y.varRemovableLayer;if(e){t.preventDefault();var n=0,i="x",a=y.thresholdValue;switch(t.keyCode){case 38:n=-a,i="y";break;case 37:n=-a;break;case 40:n=a,i="y";break;case 39:n=a;break}e.handDo(n,i)}};var x=document.getElementById("currentLayerContainer");x.addEventListener("click",(function(e){var n=e.target,i=y.varRemovableLayer;if(i){if("delete"===n.dataset.type){this.innerHTML="",t.deleteItem(i);var a=i.el;return a.parentNode.removeChild(a),void(y.varRemovableLayer=null)}if("add"===n.dataset.type){var r=this.querySelector(".set-size-block");return t.forward(i),void(r.innerHTML=i.zIndex)}if("reduce"===n.dataset.type){var s=this.querySelector(".set-size-block");return t.backoff(i),void(s.innerHTML=i.zIndex)}if("setxy"===n.dataset.type){var o=this.querySelector("[data-type='x']").value,c=this.querySelector("[data-type='y']").value;i.moveTo(o,c)}"ispeople"===n.dataset.type&&(i.isPeople=n.checked)}}));var w=document.getElementById("submitSave"),S=document.getElementById("previewBlockImg"),E=document.querySelector("#createImgBlockPopup"),C=document.querySelector("#blockCanvasContent");w.addEventListener("click",(function(){if(console.log(t),console.log(y),t.list.length)if(t.list.some((function(t){return void 0===t.isPeople})))alert("您必须设置每一层图层是否为人像层");else{var e=y.canvasSize,n=e.height,i=e.width,a=document.createElement("canvas");a.height=n,a.width=i,document.body.appendChild(a),d({el:a,width:i,height:n,background:m(y.rgb),data:t.list}),console.log(a.toDataURL("image/png"))}else alert("请上传图层")})),S.addEventListener("click",(function(){var e=y.canvasSize,n=e.height,i=e.width,a=document.createElement("canvas");a.height=n,a.width=i,d({el:a,width:i,height:n,background:m(y.rgb),data:t.list}),C.src=a.toDataURL("image/png"),E.classList.add("create-img-block-popupoff")})),E.addEventListener("click",(function(t){var e=t.target;"close"===e.dataset.type&&E.classList.remove("create-img-block-popupoff")}))}},k=(n("1fbd"),n("6b0d")),L=n.n(k);const x=L()(b,[["render",s]]);e["default"]=x},4160:function(t,e,n){"use strict";var i=n("23e7"),a=n("17c2");i({target:"Array",proto:!0,forced:[].forEach!=a},{forEach:a})},"45fc":function(t,e,n){"use strict";var i=n("23e7"),a=n("b727").some,r=n("a640"),s=n("ae40"),o=r("some"),c=s("some");i({target:"Array",proto:!0,forced:!o||!c},{some:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}})},"65f0":function(t,e,n){var i=n("861d"),a=n("e8b5"),r=n("b622"),s=r("species");t.exports=function(t,e){var n;return a(t)&&(n=t.constructor,"function"!=typeof n||n!==Array&&!a(n.prototype)?i(n)&&(n=n[s],null===n&&(n=void 0)):n=void 0),new(void 0===n?Array:n)(0===e?0:e)}},8418:function(t,e,n){"use strict";var i=n("c04e"),a=n("9bf2"),r=n("5c6c");t.exports=function(t,e,n){var s=i(e);s in t?a.f(t,s,r(0,n)):t[s]=n}},"99af":function(t,e,n){"use strict";var i=n("23e7"),a=n("d039"),r=n("e8b5"),s=n("861d"),o=n("7b0b"),c=n("50c4"),l=n("8418"),d=n("65f0"),u=n("1dde"),h=n("b622"),v=n("2d00"),f=h("isConcatSpreadable"),p=9007199254740991,m="Maximum allowed index exceeded",g=v>=51||!a((function(){var t=[];return t[f]=!1,t.concat()[0]!==t})),y=u("concat"),b=function(t){if(!s(t))return!1;var e=t[f];return void 0!==e?!!e:r(t)},k=!g||!y;i({target:"Array",proto:!0,forced:k},{concat:function(t){var e,n,i,a,r,s=o(this),u=d(s,0),h=0;for(e=-1,i=arguments.length;e<i;e++)if(r=-1===e?s:arguments[e],b(r)){if(a=c(r.length),h+a>p)throw TypeError(m);for(n=0;n<a;n++,h++)n in r&&l(u,h,r[n])}else{if(h>=p)throw TypeError(m);l(u,h++,r)}return u.length=h,u}})},a434:function(t,e,n){"use strict";var i=n("23e7"),a=n("23cb"),r=n("a691"),s=n("50c4"),o=n("7b0b"),c=n("65f0"),l=n("8418"),d=n("1dde"),u=n("ae40"),h=d("splice"),v=u("splice",{ACCESSORS:!0,0:0,1:2}),f=Math.max,p=Math.min,m=9007199254740991,g="Maximum allowed length exceeded";i({target:"Array",proto:!0,forced:!h||!v},{splice:function(t,e){var n,i,d,u,h,v,y=o(this),b=s(y.length),k=a(t,b),L=arguments.length;if(0===L?n=i=0:1===L?(n=0,i=b-k):(n=L-2,i=p(f(r(e),0),b-k)),b+n-i>m)throw TypeError(g);for(d=c(y,i),u=0;u<i;u++)h=k+u,h in y&&l(d,u,y[h]);if(d.length=i,n<i){for(u=k;u<b-i;u++)h=u+i,v=u+n,h in y?y[v]=y[h]:delete y[v];for(u=b;u>b-i+n;u--)delete y[u-1]}else if(n>i)for(u=b-i;u>k;u--)h=u+i-1,v=u+n-1,h in y?y[v]=y[h]:delete y[v];for(u=0;u<n;u++)y[u+k]=arguments[u+2];return y.length=b-i+n,d}})},a640:function(t,e,n){"use strict";var i=n("d039");t.exports=function(t,e){var n=[][t];return!!n&&i((function(){n.call(null,e||function(){throw 1},1)}))}},ae40:function(t,e,n){var i=n("83ab"),a=n("d039"),r=n("5135"),s=Object.defineProperty,o={},c=function(t){throw t};t.exports=function(t,e){if(r(o,t))return o[t];e||(e={});var n=[][t],l=!!r(e,"ACCESSORS")&&e.ACCESSORS,d=r(e,0)?e[0]:c,u=r(e,1)?e[1]:void 0;return o[t]=!!n&&!a((function(){if(l&&!i)return!0;var t={length:-1};l?s(t,1,{enumerable:!0,get:c}):t[1]=1,n.call(t,d,u)}))}},b0c0:function(t,e,n){var i=n("83ab"),a=n("9bf2").f,r=Function.prototype,s=r.toString,o=/^\s*function ([^ (]*)/,c="name";i&&!(c in r)&&a(r,c,{configurable:!0,get:function(){try{return s.call(this).match(o)[1]}catch(t){return""}}})},b727:function(t,e,n){var i=n("0366"),a=n("44ad"),r=n("7b0b"),s=n("50c4"),o=n("65f0"),c=[].push,l=function(t){var e=1==t,n=2==t,l=3==t,d=4==t,u=6==t,h=5==t||u;return function(v,f,p,m){for(var g,y,b=r(v),k=a(b),L=i(f,p,3),x=s(k.length),w=0,S=m||o,E=e?S(v,x):n?S(v,0):void 0;x>w;w++)if((h||w in k)&&(g=k[w],y=L(g,w,b),t))if(e)E[w]=y;else if(y)switch(t){case 3:return!0;case 5:return g;case 6:return w;case 2:c.call(E,g)}else if(d)return!1;return u?-1:l||d?d:E}};t.exports={forEach:l(0),map:l(1),filter:l(2),some:l(3),every:l(4),find:l(5),findIndex:l(6)}},c975:function(t,e,n){"use strict";var i=n("23e7"),a=n("4d64").indexOf,r=n("a640"),s=n("ae40"),o=[].indexOf,c=!!o&&1/[1].indexOf(1,-0)<0,l=r("indexOf"),d=s("indexOf",{ACCESSORS:!0,1:0});i({target:"Array",proto:!0,forced:c||!l||!d},{indexOf:function(t){return c?o.apply(this,arguments)||0:a(this,t,arguments.length>1?arguments[1]:void 0)}})},d81d:function(t,e,n){"use strict";var i=n("23e7"),a=n("b727").map,r=n("1dde"),s=n("ae40"),o=r("map"),c=s("map");i({target:"Array",proto:!0,forced:!o||!c},{map:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}})},e8b5:function(t,e,n){var i=n("c6b6");t.exports=Array.isArray||function(t){return"Array"==i(t)}},fb6a:function(t,e,n){"use strict";var i=n("23e7"),a=n("861d"),r=n("e8b5"),s=n("23cb"),o=n("50c4"),c=n("fc6a"),l=n("8418"),d=n("b622"),u=n("1dde"),h=n("ae40"),v=u("slice"),f=h("slice",{ACCESSORS:!0,0:0,1:2}),p=d("species"),m=[].slice,g=Math.max;i({target:"Array",proto:!0,forced:!v||!f},{slice:function(t,e){var n,i,d,u=c(this),h=o(u.length),v=s(t,h),f=s(void 0===e?h:e,h);if(r(u)&&(n=u.constructor,"function"!=typeof n||n!==Array&&!r(n.prototype)?a(n)&&(n=n[p],null===n&&(n=void 0)):n=void 0,n===Array||void 0===n))return m.call(u,v,f);for(i=new(void 0===n?Array:n)(g(f-v,0)),d=0;v<f;v++,d++)v in u&&l(i,d,u[v]);return i.length=d,i}})},fdbc:function(t,e){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}}}]);
//# sourceMappingURL=chunk-5fefb6d7.b0389947.js.map